---
layout: post
title: Set Up .NET Core 3.1 ARM Development Toolchain with Visual Studio Code
date: '2020-04-05T19:22:00.000+02:00'
author: Maurizio Attanasi
tags:
- ARM
- Linux
- macOs
- IDE
- IoT
- Windows 10
- Visual Studio Code
- ".NET Core"
- vsdbg
modified_time: '2020-04-14T19:25:36.605+02:00'
thumbnail: https://1.bp.blogspot.com/-E0NMIEmwDrc/XoiyUqZUYGI/AAAAAAAALlM/qM52DZTl5JM7H7BJb-yJ5oXF0q3haMRCACLcBGAsYHQ/s72-c/M1plus_02-900x630.jpg
blogger_id: tag:blogger.com,1999:blog-2699321970282050013.post-9000175486324542971
blogger_orig_url: https://maurizioattanasi.blogspot.com/2020/04/set-up-net-core-31-arm-development.html
---

In the previous <a href="https://maurizioattanasi.blogspot.com/2020/03/set-up-c-arm-development-toolchain-with.html" target="_blank">post</a>, I described the steps followed to set up a remote development toolchain for c++     programming on an ARM-based microcontroller (in my case, a&nbsp;<a href="https://www.friendlyarm.com/index.php?route=product/product&amp;product_id=176" target="_blank">Friendly         ELEC NanoPi M1 Plus</a>, but the same steps should be valid on the more popular <a href="https://www.raspberrypi.org/">RaspberryPi</a> ).<br /><div><br /></div><div><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-E0NMIEmwDrc/XoiyUqZUYGI/AAAAAAAALlM/qM52DZTl5JM7H7BJb-yJ5oXF0q3haMRCACLcBGAsYHQ/s1600/M1plus_02-900x630.jpg" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="630" data-original-width="900" height="224" src="https://1.bp.blogspot.com/-E0NMIEmwDrc/XoiyUqZUYGI/AAAAAAAALlM/qM52DZTl5JM7H7BJb-yJ5oXF0q3haMRCACLcBGAsYHQ/s320/M1plus_02-900x630.jpg" width="320" /></a></div><br /></div><div>In this note, I'll try to do something similar but using the latest long time support version of dotnet core,         3.1 LTS (ver. 3.1.201 at the time of writing this post).     </div><h3></h3><h3>        Pi Setup</h3><div>As for the C++ setup, we will use ssh to connect our debugger to the Pi. To debug we'll need root         privileges, and to obtain this result we need to enable ssh connection using root. </div><div>To get this result we need to edit the sshd_config configuration file by running: </div><span style="font-family: &quot;courier new&quot;;"><br /></span><span style="font-family: &quot;courier new&quot;;">sudo nano /etc/ssh/sshd_config</span>    <br /><div><br />check if the line</div><span style="font-family: &quot;courier new&quot;;"><br /></span><span style="font-family: &quot;courier new&quot;;">PermitRootLogin yes</span>    <br /><div><br />exists or, in the case, add it and then reboot the Pi</div><span style="font-family: &quot;courier new&quot;;"><br /></span><span style="font-family: &quot;courier new&quot;;">sudo reboot</span>    <br /><span style="font-family: &quot;courier new&quot;;"><br /></span><br /><h4></h4><h4>        .NET Core setup</h4><div>First thing first we need to install .net core SDK on the Pi. Following the instruction available on the <a href="https://dotnet.microsoft.com/download/dotnet-core/thank-you/sdk-3.1.201-linux-arm32-binaries" rel="nofollow">sdk's download page</a> on our ssh command line we will run the following commands:</div><br /><div style="background-color: #f7f5f5; border: 1px dashed #e0e0e0; height: 105px; overflow: auto; width: auto;"><pre>~$ sudo apt-get install curl libunwind8 gettext<br />        <br />~$ wget https://download.visualstudio.microsoft.com/download/pr/ccbcbf70-9911-40b1-a8cf-e018a13e720e/03c0621c6510f9c6f4cca6951f2cc1a4/dotnet-sdk-3.1.201-linux-arm.tar.gz                 <br />        </pre></div><br /><div>The next step is to extract the packages we downloaded, and make the dotnet commands available at the terminal     </div><br /><div style="background-color: #f7f5f5; border: 1px dashed #e0e0e0; height: auto; overflow: auto; width: auto;"><pre>~$ mkdir -p $HOME/dotnet &amp;&amp; tar zxf dotnet-sdk-3.1.201-linux-arm.tar.gz -C $HOME/dotnet<br />~$ export DOTNET_ROOT=$HOME/dotnet<br />~$ export PATH=$PATH:$HOME/dotnet<br />        </pre></div><br />In order to verify the installation, in our ssh terminal, run the <span style="font-family: &quot;courier new&quot;;">dotnet         --info</span> command. If everything is ok something like     this should appear.<br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-Feip_l1_Q2A/XomKUHVFeBI/AAAAAAAALlY/GLvRaTW8T9gw-Kovi-Nw-WNi0XY0a8vNQCLcBGAsYHQ/s1600/dotnet-info.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="564" data-original-width="682" height="264" src="https://1.bp.blogspot.com/-Feip_l1_Q2A/XomKUHVFeBI/AAAAAAAALlY/GLvRaTW8T9gw-Kovi-Nw-WNi0XY0a8vNQCLcBGAsYHQ/s320/dotnet-info.png" width="320" /></a></div><div><br />As stated in the .NET Core download page</div><br /><div class="col-lg-4"><div style="background-color: lightyellow; color: #333333; padding: 15px 15px 15px 40px; width: 300px;"><i aria-hidden="true" class="fa fa-exclamation-triangle"></i> The above commands will only make the .NET SDK             commands             available for the terminal session in which it was run.<br />You can edit your shell profile to permanently add the commands. There are a number of different shells             available for Linux and each has a different profile. For example:             <br /><ul><li>Bash Shell: ~/.bash_profile, ~/.bashrc</li><li>Korn Shell: ~/.kshrc or .profile</li><li>Z Shell: ~/.zshrc or .zprofile</li></ul>Edit the appropriate source file for you shell and add :$HOME/dotnet to the end of the existing PATH             statement. If no PATH statement is included, add a new line with export PATH=$PATH:$HOME/dotnet.             <br />Also, add export DOTNET_ROOT=$HOME/dotnet to the end of the file.         </div></div><h4></h4><h4></h4><h4>        VS Remote Debugger Setup</h4><div>To install the vscode remote debugger on the NanoPi, on the ssh terminal rin the command:</div><br /><div style="background-color: #f7f5f5; border: 1px dashed #e0e0e0; height: auto; overflow: auto; width: auto;">~$ curl -sSL https://aka.ms/getvsdbgsh | /bin/sh /dev/stdin -v latest -l ~/vsdbg     </div><h3></h3><h3>        Visual Studio Code remote debugging test</h3><div>Now it's time to test the whole toolchain. </div><br /><div>On our development machine (in my case an old MacBook Pro 15), we need the dotnet SDK installed, and, of course         our favorite code editor <a href="https://code.visualstudio.com/">Visual Studio Code</a>.</div><br /><div>To achieve the goal, we will use a simple console application named <span style="font-family: &quot;courier new&quot;;">toolchain-test</span></div><br /><div>In order to verify the machine on which we are running our simple test program we'll change the code as follows:         <br /><br /><div style="background-color: #f7f5f5; border: 1px dashed #e0e0e0; height: auto; overflow: auto; width: auto;"><pre>    using System;<br /><br />    namespace toolchain_test<br />    {<br />        class Program<br />        {<br />            static void Main(string[] args)<br />            {<br />                var logName = Environment.GetEnvironmentVariable("LOGNAME");<br />                Console.WriteLine($"Hello World! from {logName}");<br />            }<br />        }<br />    }                <br />            </pre></div></div><br /><div>As we did for the <a href="https://maurizioattanasi.blogspot.com/2020/03/set-up-c-arm-development-toolchain-with.html">C++             toolchain</a> we will make use of <a href="https://linux.die.net/man/1/rsync"><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">rsync</span></a>, a copying tool         available on macOS, Linux, and now also on Windows 10 via the Windows Subsystem for Linux or <a href="https://docs.microsoft.com/it-it/windows/wsl/about">WSL2</a> so our         <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">task.json</span> and <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">launch.json</span> files         will be:     </div><br /><div style="background-color: #f7f5f5; border: 1px dashed #e0e0e0; height: auto; overflow: auto; width: auto;"><pre>        {<br />            "version": "2.0.0",<br />            "tasks": [<br />                {<br />                    "label": "build",<br />                    "command": "dotnet",<br />                    "type": "process",<br />                    "args": [<br />                        "build",<br />                        "${workspaceFolder}/toolchain-test/toolchain-test.csproj",<br />                        "/property:GenerateFullPaths=true",<br />                        "/consoleloggerparameters:NoSummary"<br />                    ],<br />                    "problemMatcher": "$msCompile"<br />                },  <br />                {<br />                    "label": "publish",<br />                    "command": "dotnet",<br />                    "dependsOn": "build",<br />                    "type": "process",<br />                    "args": [<br />                        "publish",<br />                        "-r",<br />                        "linux-arm",<br />                        "${workspaceFolder}/toolchain-test/toolchain-test.csproj",<br />                        "/property:GenerateFullPaths=true",<br />                        "/consoleloggerparameters:NoSummary"<br />                    ],<br />                    "problemMatcher": "$msCompile"<br />                },<br />                {<br />                    "label": "rsync",<br />                    "type": "shell",<br />                    "dependsOn": "publish",<br />                    "osx": {<br />                        "command": "rsync -r -a -v -e ssh --delete toolchain-test/bin/Debug/netcoreapp3.1/linux-arm/ pi@192.168.1.177:/home/pi/projects/toolchain-test/"<br />                    }<br />                },<br />                {<br />                    "label": "watch",<br />                    "command": "dotnet",<br />                    "type": "process",<br />                    "args": [<br />                        "watch",<br />                        "run",<br />                        "${workspaceFolder}/toolchain-test/toolchain-test.csproj",<br />                        "/property:GenerateFullPaths=true",<br />                        "/consoleloggerparameters:NoSummary"<br />                    ],<br />                    "problemMatcher": "$msCompile"<br />                }<br />            ]<br />        }        <br />    </pre></div><br /><div style="background-color: #f7f5f5; border: 1px dashed #e0e0e0; height: auto; overflow: auto; width: auto;"><pre>        {<br />            // Use IntelliSense to find out which attributes exist for C# debugging<br />            // Use hover for the description of the existing attributes<br />            // For further information visit https://github.com/OmniSharp/omnisharp-vscode/blob/master/debugger-launchjson.md<br />            "version": "0.2.0",<br />            "configurations": [<br />                {<br />                    "name": ".NET Core Launch (console)",<br />                    "type": "coreclr",<br />                    "request": "launch",<br />                    "preLaunchTask": "build",<br />                    "program": "${workspaceFolder}/toolchain-test/bin/Debug/netcoreapp3.1/toolchain-test.dll",<br />                    "args": [],<br />                    "cwd": "${workspaceFolder}",<br />                    "console": "internalConsole",<br />                    "stopAtEntry": false<br />                },<br />                {<br />                    "name": ".NET Core Remote Launch - Standalone Application (console)",<br />                    "type": "coreclr",<br />                    "request": "launch",<br />                    "program": "toolchain-test",<br />                    "args": [],<br />                    "cwd": "~/projects/toolchain-test",<br />                    "stopAtEntry": false,<br />                    "console": "internalConsole",<br />                    "pipeTransport": {<br />                        "pipeCwd": "${workspaceRoot}",<br />                        "pipeProgram": "/usr/bin/ssh",<br />                        "pipeArgs": [<br />                            "-T",<br />                            "pi@192.168.1.177"<br />                        ],<br />                        "debuggerPath": "~/vsdbg/vsdbg"<br />                    },<br />                    "preLaunchTask": "rsync",<br />                },        <br />                {<br />                    "name": ".NET Core Attach",<br />                    "type": "coreclr",<br />                    "request": "attach",<br />                    "processId": "${command:pickProcess}"<br />                }<br />            ]<br />        }        <br />    </pre></div><br /><div>In the <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">launch.json</span>        we have two configurations, a local and a remote one.         <br /><br />Selecting the local one:<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-ft_g5o6XLvE/XomsFft3w0I/AAAAAAAALlk/Y6CO5j3ne6oPpLCGvOdu1BDKm6MLV_QHwCLcBGAsYHQ/s1600/local-debug.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="45" data-original-width="402" height="35" src="https://1.bp.blogspot.com/-ft_g5o6XLvE/XomsFft3w0I/AAAAAAAALlk/Y6CO5j3ne6oPpLCGvOdu1BDKm6MLV_QHwCLcBGAsYHQ/s320/local-debug.png" width="320" /></a></div><br />and pressing F5, the program will stop at the breakpoint as we can see in the following picture:<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-9Tfi-F_qUdo/Xomt76C0L6I/AAAAAAAALlw/v9syJBVO5CQpNp580GnAxc8KS6Lp4mPxACLcBGAsYHQ/s1600/local-breakpopint.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="96" data-original-width="363" height="84" src="https://1.bp.blogspot.com/-9Tfi-F_qUdo/Xomt76C0L6I/AAAAAAAALlw/v9syJBVO5CQpNp580GnAxc8KS6Lp4mPxACLcBGAsYHQ/s320/local-breakpopint.png" width="320" /></a></div><br />and the program output will be:<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-_qc4IpCu06I/XomuKWxeEQI/AAAAAAAALl0/iLOgU0AoXUwfVVpTsQIB621WwujloYSXwCLcBGAsYHQ/s1600/local-console.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="58" data-original-width="295" src="https://1.bp.blogspot.com/-_qc4IpCu06I/XomuKWxeEQI/AAAAAAAALl0/iLOgU0AoXUwfVVpTsQIB621WwujloYSXwCLcBGAsYHQ/s1600/local-console.png" /></a>        </div><br />Selecting the remote debug configuration, we will have instead:<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-eBNUdBsQdkE/XomugFplkwI/AAAAAAAALmA/xRt_lb_IwNMs_m-RY-h8Lk-YP6prWDkvQCLcBGAsYHQ/s1600/remote-debug.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="35" data-original-width="370" height="30" src="https://1.bp.blogspot.com/-eBNUdBsQdkE/XomugFplkwI/AAAAAAAALmA/xRt_lb_IwNMs_m-RY-h8Lk-YP6prWDkvQCLcBGAsYHQ/s320/remote-debug.png" width="320" /></a></div><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-g_jLCT_y2NY/XomudpfIhsI/AAAAAAAALl8/BCZuOSbOGVopIBRICsCVIgMZxI2_TY8jQCEwYBhgLKs4DAMBZVoA4veEi53RtOoVPwB2jiUcCHIADM0Bw-f0GDIRNZ_3ocF_KoJWW4gggVC9iUdxIHD0Aw6dY7D_pzje67A7H15XjdHRTKU3MDaQ4Qbd-rbl89acdSmf9hWCE4z_H6IkbfBPxoezSOh-Csoj3dkWUPO6I88qbAJ5lRW7TMIgJRSpjh2wfIquGpmlJo6JqjdhMuq1gJLZRb6Woyxj6_Obq0YCtT0mNLjIcNp3ddznJEIO6tinA54FBKztWmjlcMIlUi8dmUcesdepEHoq26aDmbN84HchQG88RnXVSCdnl0_nIndqxhNZvgC1cMmZGX_YMqXNeGMh8GjNsB5uDoD9SUn9Blc0wz_J_VP9maj_GcxEZAxcF4y9otFkBXSHX75422dAbiSZkrP16_jfK-GIP-lNaM1HZmYouiumibzvt87ntNaaTpBRQXIgkKyr2zOa6XYxpV9ik4hHrCueDPLp0mSmbMa-E64I39HCwjM2YNeNU9ofdGrOYIMy4vbutxPD0oQYAa4Btam4goOw--i0Vez-GgbhK-PlaAW_4zlkh7vuLrIQrqS3NQ6tZy8ljhzqkfhhHvrc9hfnKV3LK0HTFWAA8MyvcG5JIpx_XMO7hpvQF/s1600/remote-breakpoint.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="115" data-original-width="359" height="101" src="https://1.bp.blogspot.com/-g_jLCT_y2NY/XomudpfIhsI/AAAAAAAALl8/BCZuOSbOGVopIBRICsCVIgMZxI2_TY8jQCEwYBhgLKs4DAMBZVoA4veEi53RtOoVPwB2jiUcCHIADM0Bw-f0GDIRNZ_3ocF_KoJWW4gggVC9iUdxIHD0Aw6dY7D_pzje67A7H15XjdHRTKU3MDaQ4Qbd-rbl89acdSmf9hWCE4z_H6IkbfBPxoezSOh-Csoj3dkWUPO6I88qbAJ5lRW7TMIgJRSpjh2wfIquGpmlJo6JqjdhMuq1gJLZRb6Woyxj6_Obq0YCtT0mNLjIcNp3ddznJEIO6tinA54FBKztWmjlcMIlUi8dmUcesdepEHoq26aDmbN84HchQG88RnXVSCdnl0_nIndqxhNZvgC1cMmZGX_YMqXNeGMh8GjNsB5uDoD9SUn9Blc0wz_J_VP9maj_GcxEZAxcF4y9otFkBXSHX75422dAbiSZkrP16_jfK-GIP-lNaM1HZmYouiumibzvt87ntNaaTpBRQXIgkKyr2zOa6XYxpV9ik4hHrCueDPLp0mSmbMa-E64I39HCwjM2YNeNU9ofdGrOYIMy4vbutxPD0oQYAa4Btam4goOw--i0Vez-GgbhK-PlaAW_4zlkh7vuLrIQrqS3NQ6tZy8ljhzqkfhhHvrc9hfnKV3LK0HTFWAA8MyvcG5JIpx_XMO7hpvQF/s320/remote-breakpoint.png" width="320" /></a></div><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-d59rcv8qDpg/XomuqIJLvqI/AAAAAAAALmE/7dNE24iskVE7G5wsP7HhqgECl4Z5Xu1TwCLcBGAsYHQ/s1600/remote-console.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="104" data-original-width="262" src="https://1.bp.blogspot.com/-d59rcv8qDpg/XomuqIJLvqI/AAAAAAAALmE/7dNE24iskVE7G5wsP7HhqgECl4Z5Xu1TwCLcBGAsYHQ/s1600/remote-console.png" /></a>        </div><br />As we can see, in the first test, the <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">logName</span> variable         assumes the development machine <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">LOGNAME</span> environment         variable value, while in the second it assumes the <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">Pi's</span> one.     </div><br /><div>The code of this note is available <a href="https://github.com/alien70/vscode-arm-c-sharp-toolchain">here</a> on         my Github repo.     </div><br /><div>As always<br /><br />Enjoy,<br /><br />and if we are still under COVID-19 attack, #staysafe, #StayAtHome.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-VPpx7wpWqMk/Xom1ZaYbINI/AAAAAAAALmU/srDW2xp9I_kHGJHP2J_Q2QE4-APN0vPZQCLcBGAsYHQ/s1600/stay-at-home_2x.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="600" data-original-width="800" height="240" src="https://1.bp.blogspot.com/-VPpx7wpWqMk/Xom1ZaYbINI/AAAAAAAALmU/srDW2xp9I_kHGJHP2J_Q2QE4-APN0vPZQCLcBGAsYHQ/s320/stay-at-home_2x.png" width="320" /></a></div><br /></div>